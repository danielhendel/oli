// components/dev/DevConsole.tsx (snippet)
import React from "react";
import { View } from "react-native";
import { Button } from "../../lib/ui/Button";
import { Body } from "../../lib/ui/Text";
import { useTheme } from "../../lib/theme/ThemeProvider";
import { runFirestoreProbe, type ProbeResult } from "../../lib/dev/firebaseProbe";

export default function DevConsole() {
  const theme = useTheme();
  const [probe, setProbe] = React.useState<ProbeResult | null>(null);
  const [busy, setBusy] = React.useState(false);

  const onProbe = async () => {
    if (busy) return;
    setBusy(true);
    try {
      const res = await runFirestoreProbe();
      setProbe(res);
    } finally {
      setBusy(false);
    }
  };

  return (
    <View style={{ gap: 12 }}>
      <Button label={busy ? "Running…" : "Run Firebase Probe"} onPress={onProbe} disabled={busy} />
      {probe && (
        <View
          style={{
            padding: 12,
            borderRadius: 12,
            backgroundColor: probe.status === "success" ? theme.cardBg : theme.cardBg,
            borderWidth: 1,
            borderColor: probe.status === "success" ? theme.border : theme.danger,
          }}
        >
          <Body style={{ color: probe.status === "success" ? theme.text : theme.danger }}>
            {`${probe.mode.toUpperCase()} • ${probe.status.toUpperCase()}: ${probe.message}`}
          </Body>
        </View>
      )}
    </View>
  );
}
